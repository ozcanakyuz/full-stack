{% extends "base.html" %}
{% load static %}

{% block body %}

{% comment %}!-- Card Detail --> {% endcomment %}
{% comment %} modal fade {% endcomment %}
<div class="containerlog m-auto px-3" id="containerdetail" style="margin-top: 4rem !important;">
    {% comment %} <div class="text-right w-100 p-1 m-1">
        <btn class="btn btn-outline-danger rounded">CLOSE</btn>
    </div> {% endcomment %}
    <div class="card align-items-center rounded my-4">
        {% if post_detail.image %}
        <img src="{{ post_detail.image.url }}" class="card-img-top" alt="...">
        {% else %}
        <img src="" class="card-img-top py-4 w-75" alt="NO PHOTO!!">
        {% endif %}
    </div>
    <div class="card-body w-100 pb-3">
        <h5 class="card-title">{{ post_detail.user.get_full_name }}</h5>
        <p class="card-text">{{ post_detail.title }}</p>
        <p class="card-text"><small class="text-muted">{{ post_detail.create_at }}</small></p>
    </div>
</div>

{% comment %} ! COMMENTS {% endcomment %}
{% for comment in comments %}
<div class="containerlog m-auto p-4" style="margin-top: 1rem !important;" >
    <div class="media-body d-flex">
        <img src="{{ comment.user.userprofile.image.url }}" alt="Image" class="mr-3 mt-1 rounded-circle mb-3" style="width:60px;">
        <div>
            <h4>{{ comment.user.get_full_name }} <small class="h6"> - <i>{{ comment.create_at }}</i></small></h4>
            <p>{{ comment.comment }}</p>
        </div>
        <hr>
        <div class="media-text d-flex flex-column-reverse">
            <a type="text" data-toggle="collapse" data-target="#reply{{comment.id}}" class="btn float-right btn-success rounded shadow-sm " href="">Reply</a><br>
        </div>

            <div id="reply{{comment.id}}" class="collapse in">

                <form method="post" action="/replycomment/{{comment.id}}"> 
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="message">Your Message*</label>
                        <textarea id="message" cols="30" rows="5" class="form-control" name="repcomment"></textarea>
                    </div>
                    <div class="form-group mb-0">
                    {% if user.id is not None %}
                        <input type="submit" value="Reply" class="btn btn-success float-right rounded shadow-sm ml-2">
                    {% else %}
                        <a href="/login">You must be logged in to post a review</a>
                    {% endif %} 
                    </div>
                </form>
            </div>
        {% if repcomments %}
            {% for repcomment in repcomments %}
            <div class="media bg-light mt-4 p-4 rounded">
                <img src="{{ repcomment.user.userprofile.image.url }}" alt="Image" class="mr-3 mt-1 rounded-circle" style="width:60px;">
                <div class="media-body">
                    <h4>{{ repcomment.user.get_full_name }} <small> - <i>{{ repcomment.create_at }}</i></small></h4>
                    <p>{{ repcomment.repcomment }}</p>
                   <hr>
                </div>
            </div>
            {% endfor %}
        {% endif %}
    </div>
</div>
{% endfor %}


<div class="containerlog m-auto p-3" style="margin-top: 1rem !important;">
    <form action="/addcomment/{{ post_detail.id }}" method="POST">
        {% csrf_token %}
        <div class="form-group">
            <label for="message">Your Message*</label>
            <textarea id="message" cols="30" rows="5" name="comment" class="form-control"></textarea>
        </div>
        {% comment %} <div class="form-group">
            <label for="subject">Subject*</label>
            <input type="text" class="form-control" id="message" name="subject">
        </div>
        <div class="form-group">
            <label for="name">Your Name*</label>
            <input type="text" name="user" class="form-control" id="name">
        </div> {% endcomment %}
        <div class="form-group mb-0">
        {% if user.id is not None %}
            <input type="submit" value="Leave Your Review" class="btn btn-outline-success px-3 mt-2 rounded shadow-sm float-right">
        {% else %}
            <a href="/login">You must be logged in to post a review</a>
        {% endif %} 
        </div>
    </form>
</div>





{% comment %} !-- Card Detail --> {% endcomment %}

{% endblock %}